<!doctype html>
<html lang="th">
<head>
<meta charset="utf-8">
<title>ใบเสร็จรับเงิน - Heaven Furniture</title>
<link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>
    body { 
        background: url("banner 2/bg.png") no-repeat fixed center; 
        background-size: cover; 
        display: flex; 
        justify-content: center; 
        align-items: center; 
        min-height: 100vh; 
        font-family: 'Prompt', sans-serif; 
        margin: 0; 
    }
    
    .receipt-card { 
        background: white; 
        padding: 40px; 
        border-radius: 25px; 
        box-shadow: 0 20px 60px rgba(0,0,0,0.15); 
        width: 480px; 
        text-align: center; 
        animation: slideUp 0.5s ease-out;
    }

    @keyframes slideUp {
        from { transform: translateY(30px); opacity: 0; }
        to { transform: translateY(0); opacity: 1; }
    }

    h1 { color: #333; font-size: 24px; margin-bottom: 25px; }

    .receipt-box { 
        background: #fcfcfc; 
        border: 2px dashed #e0e0e0; 
        padding: 25px; 
        border-radius: 15px; 
        text-align: left; 
        margin-bottom: 30px;
    }

    .row { display: flex; justify-content: space-between; margin-bottom: 12px; font-size: 14px; }
    .row span { color: #888; }
    .row b { color: #333; font-weight: 600; }
    
    .address-box { background: #f0f0f0; padding: 10px; border-radius: 10px; margin-top: 5px; font-size: 13px; line-height: 1.5; }

    .divider { height: 1px; background-color: #eee; margin: 15px 0; }
    
    .item-list { max-height: 150px; overflow-y: auto; }
    .item-row { display: flex; justify-content: space-between; font-size: 14px; margin-bottom: 8px; }

    .total-price { font-size: 24px; font-weight: bold; color: #b5835a; }

    .btn-confirm-main { 
        background: #222; color: white; padding: 15px 80px; 
        border: none; border-radius: 50px; font-weight: bold; 
        font-size: 18px; cursor: pointer; transition: 0.3s;
    }
    .btn-confirm-main:hover { background: #000; transform: scale(1.05); }

    .modal-overlay {
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background: rgba(0,0,0,0.6); display: none;
        justify-content: center; align-items: center; z-index: 1000;
    }
    .modal-content {
        background: white; padding: 40px; border-radius: 25px;
        width: 420px; text-align: center; position: relative;
    }
    .modal-icon-circle {
        width: 80px; height: 80px; border-radius: 50%; 
        display: flex; justify-content: center; align-items: center; 
        margin: 0 auto 20px; font-size: 40px; font-weight: bold;
    }
    .icon-confirm { background: #b5835a; color: white; }
    .icon-success { background: #e8f5e9; color: #4caf50; }

    .modal-title { font-size: 22px; font-weight: bold; margin-bottom: 10px; }
    .modal-text { color: #777; margin-bottom: 30px; font-size: 15px; }

    .btn-group { display: flex; gap: 15px; }
    .btn-modal { 
        flex: 1; padding: 12px; border-radius: 50px; border: none; 
        font-weight: bold; cursor: pointer; font-family: 'Prompt';
    }
    .btn-back { background: white; border: 1.5px solid #ddd; color: #888; }
    .btn-brown { background: #b5835a; color: white; }
</style>
</head>
<body>

<div class="receipt-card">
    <h1>ตรวจสอบข้อมูล</h1>
    <div class="receipt-box">
        <div class="row"><span>เลขที่สั่งซื้อ:</span><b id="resNo">-</b></div>
        <div class="row"><span>วันที่:</span><b id="resDate">-</b></div>
        <div class="row"><span>ผู้รับ:</span><b id="resName">-</b></div>
        <div class="row" style="flex-direction:column;">
            <span>ที่อยู่จัดส่ง:</span>
            <div class="address-box" id="resAddr">-</div>
        </div>
        <div class="divider"></div>
        <div class="item-list" id="resItems"></div>
        <div class="divider"></div>
        <div style="display:flex; justify-content:space-between; align-items:center;">
            <b style="font-size:16px;">ยอดสุทธิ</b>
            <span class="total-price" id="resTotal">0 THB</span>
        </div>
    </div>
    <button class="btn-confirm-main" onclick="openConfirm()">ยืนยัน</button>
</div>

<div id="confirmModal" class="modal-overlay">
    <div class="modal-content">
        <div class="modal-icon-circle icon-confirm">?</div>
        <div class="modal-title">ยืนยันการสั่งซื้อ</div>
        <div class="modal-text">คุณตรวจสอบข้อมูลครบถ้วน<br>และต้องการยืนยันการสั่งซื้อนี้จริงหรือไม่?</div>
        <div class="btn-group">
            <button class="btn-modal btn-back" onclick="closeModal('confirmModal')">กลับไปแก้ไข</button>
            <button class="btn-modal btn-brown" onclick="showSuccess()">ยืนยันการสั่งซื้อ</button>
        </div>
    </div>
</div>

<div id="successModal" class="modal-overlay">
    <div class="modal-content">
        <div class="modal-icon-circle icon-success">✓</div>
        <div class="modal-title">สั่งซื้อเรียบร้อย!</div>
        <div class="modal-text">ทางเราได้รับข้อมูลการชำระเงินของคุณแล้ว<br>ขอบคุณที่ไว้วางใจ Heaven Furniture ครับ</div>
        <button class="btn-modal btn-brown" style="width:100%" onclick="finishOrder()">กลับไปเลือกซื้อสินค้าต่อ</button>
    </div>
</div>

<script>

    window.onload = function() {
        const data = JSON.parse(localStorage.getItem("receiptData"));
        if (data) {
            document.getElementById("resNo").innerText = data.orderNo;
            document.getElementById("resDate").innerText = data.date;
            
            let namePart = data.customerName.split("(")[0].trim();
            let addrPart = data.customerName.includes(")") ? data.customerName.split(")")[1].trim() : "";
            
            document.getElementById("resName").innerText = namePart;
            document.getElementById("resAddr").innerText = addrPart || "ข้อมูลที่อยู่";
            document.getElementById("resTotal").innerText = data.totalPrice.toLocaleString() + " THB";

            let itemsHtml = "";
            data.items.forEach(item => {
                itemsHtml += `
                    <div class="item-row">
                        <span>${item.name} (x${item.qty})</span>
                        <b>${item.price.toLocaleString()}</b>
                    </div>`;
            });
            document.getElementById("resItems").innerHTML = itemsHtml;
        }
    };

    function openConfirm() { document.getElementById('confirmModal').style.display = 'flex'; }
    function closeModal(id) { document.getElementById(id).style.display = 'none'; }
    
    function showSuccess() {
        closeModal('confirmModal');
        document.getElementById('successModal').style.display = 'flex';
    }

    function finishOrder() {
      
        localStorage.removeItem("receiptData");
        localStorage.removeItem("cart");
        localStorage.removeItem("checkoutItem");
        
        window.location.href = "index.html";
    }
</script>

</body>
</html>
